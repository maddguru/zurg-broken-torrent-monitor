# Version 2.2 Update Notes

## üéØ What's New in v2.2

Version 2.2 adds comprehensive **total torrent statistics** to give you full visibility into your entire Zurg torrent collection, not just broken or under-repair torrents.

---

## ‚ú® New Features

### üìä Total Torrent Statistics Display

The script now shows a complete overview of your torrent library at every check:

```
TORRENT STATISTICS:
  Total Torrents:            5,277
  OK Torrents:               5,264 (99.75%)
  Broken:                        8 (0.15%)
  Under Repair:                  5 (0.10%)
```

**What This Gives You:**
- **Total Torrents**: Complete count of all torrents in Zurg
- **OK Torrents**: How many are working perfectly (with percentage)
- **Broken**: Count and percentage of broken torrents
- **Under Repair**: Count and percentage of torrents being repaired

### üîç Better Context for Health Monitoring

Previously, you only saw absolute numbers like "8 broken torrents". Now you can see this in context:
- 8 broken out of 100 torrents = 8% (concerning)
- 8 broken out of 5,000 torrents = 0.16% (healthy)

This helps you understand whether intervention is needed or if everything is running smoothly.

---

## üîß Technical Changes

### New Function: `Get-ZurgTotalTorrentStats`
- Fetches the complete torrent list from `/manage/`
- Counts unique torrent hashes using regex pattern matching
- Returns total torrent count for statistical calculations

### Enhanced Statistics Tracking
```powershell
$Script:Stats.CurrentCheck = @{
    # Existing fields
    BrokenFound = 0
    UnderRepairFound = 0
    RepairsTriggered = 0
    # ... existing arrays ...
    
    # NEW in v2.2
    TotalTorrents = 0
    OkTorrents = 0
}
```

### Updated Display Logic
- New `TORRENT STATISTICS` section in check summary
- Automatic percentage calculations
- Color-coded health indicators:
  - **Green**: OK torrents (healthy)
  - **Yellow/Gray**: Broken (based on count)
  - **Cyan/Gray**: Under repair (based on count)

---

## üìà Example Output

### Before (v2.1):
```
CURRENT CHECK RESULTS:
  Broken Torrents:           8
  Under Repair:              5
  Repairs Triggered:         13
```

### After (v2.2):
```
TORRENT STATISTICS:
  Total Torrents:            5,277
  OK Torrents:               5,264 (99.75%)
  Broken:                        8 (0.15%)
  Under Repair:                  5 (0.10%)

CURRENT CHECK RESULTS:
  Broken Torrents:           8
  Under Repair:              5
  Repairs Triggered:         13
```

---

## üöÄ Performance Impact

**Minimal Performance Impact:**
- Adds one additional API call to `/manage/` per check
- Typical fetch time: <1 second for libraries up to 10,000+ torrents
- Uses efficient regex pattern matching for hash extraction
- No impact on repair logic or trigger timing

---

## üì¶ Upgrade Instructions

### From v2.1 to v2.2:

1. **Download the new script:**
   - Replace your existing `Zurg-Broken-Torrent-Monitor.ps1` with v2.2

2. **No configuration changes needed:**
   - All existing parameters work exactly the same
   - No breaking changes to command-line arguments

3. **Restart your monitoring:**
   ```powershell
   # If running as a service, restart it
   Restart-Service "ZurgBrokenTorrentMonitor"
   
   # Or if running manually, just start the new version
   .\Zurg-Broken-Torrent-Monitor.ps1 -ZurgUrl "http://localhost:9999"
   ```

4. **Verify the upgrade:**
   - Look for the banner: `ZURG BROKEN TORRENT MONITOR v2.2`
   - Check summary should now show `TORRENT STATISTICS` section

---

## üêõ Bug Fixes

None - this is a pure feature addition release.

---

## üîú What's Next?

Potential features being considered for v2.3+:
- Webhook/Discord notifications
- Email alerts for persistent issues
- JSON/CSV export of statistics
- Configurable retry intervals for under-repair torrents
- Historical trend tracking

---

## üí¨ Feedback

Found a bug or have a feature request? Please open an issue on GitHub!

---

## üìö Full Feature List (v2.2)

- ‚úÖ Monitors broken torrents
- ‚úÖ Monitors under-repair torrents
- ‚úÖ Automatically triggers repairs
- ‚úÖ **NEW: Total torrent statistics with percentages**
- ‚úÖ **NEW: OK torrent count and health percentage**
- ‚úÖ Tracks repair progress between checks
- ‚úÖ Shows repair success rates
- ‚úÖ Color-coded console output
- ‚úÖ Comprehensive logging
- ‚úÖ Configurable intervals
- ‚úÖ Single-run or continuous monitoring
- ‚úÖ Basic authentication support
- ‚úÖ Verbose debugging mode

---

**Released:** November 2025  
**Compatibility:** Requires Zurg with `/manage/` API access
